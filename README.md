# master_thesis
This repository contains all the scripts and functions used in Blas Chaves-Urbano master's thesis made in the Macintyre Lab at CNIO

This repository is divided in different folders which contains the scripts and files neccesary to reproduce undertaken in this master thesis:

- get_results: This folder contains the code for getting the copy-number signatures results and figures (get_results.R). This script is compiled from BRITOC CNsignatures which contains all the code necessary to reproduce the analyses for the accompaning manuscript "Copy-number signatures and mutational processes in ovarian carcinoma" (https://www.biorxiv.org/content/early/2017/09/04/174201). Details on how to compile the document can be found in the repository README: https://bitbucket.org/britroc/cnsignatures. Much of the code for the signature analysis can be found in the main_functions.R and helper_functions.R files in the base directory of the previous repository. This folder also contains the file cdks_30_kb_14_30kb_ds_absCopyNumber.rds. This file has the absolute copy number profiles of the different experimental cell lines generated using a modified implementation of the QDNAseq package in R designed by Dr. Geoff Macintyre (unpublished).

- unique_cn: This folder contains the code neccestary for determine the unique copy number changes from the absolute copy number profiles. The function unify_segements_boundaries.R is used for calculating these unique events and for unifying segments boundaries across cells. The script fix_boundaries.R contains how the unique copy number events of this master's thesis experimental data was obtained and plot. Plotting functions are included in the plot_functions folder.

- quality tool: This folder contains the novel-developed quality control tool designed in this master's thesis. CellLines_CNData.R This script contains the code for obtaining the copy-number data of the 1421 cell lines from the database (files required: cellLine_segment_ascat_sc_fixed_purity_tCN.rds and cellLine_CEL_file_mapping.tsv). The output of this script is a .rds file containing the matrix of all copy-number data from the 1421 cell lines and my master's samples (CNMatrix_CellLines_round.rds). The script CellLines_CNComparison.R, contains the code for comparing the copy-number profiles between the QDNAseq-CopyNumber generated data and the 1421 cell lines data from the data base. Plotting functions are included in the plot_functions folder. 

- plot_functions: This folder contains all the functions used in this master thesis for plotting. CNPlot_from_segTab.R is used for plotting two copy number profiles at the same time. CNPlot_from_segTab.R is used for plotting two copy number profiles at the same time only in the selected chromosome. plot_dif_cn.R is used for plotting two unique copy number profiles from two different samples, highliting the different events observed. plot_dif_by_chrom.R makes the same as the function before but only in the selected chromosome. unique_events_from_chr.R is used for extracting the unique events from a selected chromosome. hg19.chrom.sizes.txt has the sizes of the different chromosomes. This file is essential for plotting the chromosome in a size dependent manner.

 
